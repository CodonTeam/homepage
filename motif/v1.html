<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Motif V1 Specs - Codon Lab</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #fafafa; color: #171717; }
        .font-mono { font-family: 'JetBrains Mono', monospace; }
        .grid-bg {
            background-image: linear-gradient(#e5e5e5 1px, transparent 1px),
            linear-gradient(90deg, #e5e5e5 1px, transparent 1px);
            background-size: 40px 40px;
            background-position: center top;
        }
        .glass-card {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }
        
        /* 优化的代码块样式 */
        .code-window {
            background-color: #171717; /* 更深邃的黑 */
            border-radius: 0.5rem;
            overflow: hidden;
            border: 1px solid #262626;
        }
        .code-header {
            background-color: #1e1e1e;
            padding: 0.5rem 1rem;
            display: flex;
            align-items: center;
            border-bottom: 1px solid #262626;
        }
        .code-content {
            color: #d4d4d4;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem; /* 稍微调小一点字体，更像编辑器 */
            line-height: 1.6;
            padding: 1.5rem;
            overflow-x: auto;
            white-space: pre-wrap; 
            word-break: break-all;
        }
        
        /* 简单的语法高亮类 */
        .hl-cls { color: #4ec9b0; font-weight: bold; } 
        .hl-attr { color: #9cdcfe; } 
        .hl-num { color: #b5cea8; } 
        .hl-str { color: #ce9178; } 
        .hl-kw { color: #569cd6; } 
        .hl-comment { color: #6a9955; } 
        
        .flow-arrow {
            color: #d1d5db; 
            font-size: 1.25rem;
        }
        @media (max-width: 768px) {
            .flow-arrow { transform: rotate(90deg); margin: 0.5rem 0; }
        }
    </style>
</head>
<body class="grid-bg min-h-screen flex flex-col">

    <!-- Nav -->
    <nav class="w-full py-5 px-6 md:px-12 flex justify-between items-center glass-card sticky top-0 z-50">
        <a href="/" class="text-lg font-semibold tracking-tight flex items-center gap-2 text-gray-900">
            <div class="w-2.5 h-2.5 bg-blue-600 rounded-sm"></div>
            Codon Lab
        </a>
        <div class="flex gap-4 text-sm font-medium text-gray-500">
            <a href="/models" class="hover:text-black transition">← Back to Models</a>
        </div>
    </nav>

    <main class="max-w-6xl mx-auto w-full px-6 py-12 md:flex gap-16 items-start">
        
        <!-- Sidebar: Meta Info (Sticky) -->
        <aside class="w-full md:w-1/4 mb-10 md:mb-0 space-y-8 flex-shrink-0 md:sticky md:top-28 self-start">
            <div>
                <h1 class="text-3xl font-bold text-gray-900 mb-2">Motif V1</h1>
                <div class="inline-flex items-center gap-2 px-2 py-1 bg-green-50 text-green-700 text-xs font-mono rounded border border-green-100">
                    <span class="w-1.5 h-1.5 bg-green-500 rounded-full"></span>
                    STABLE
                </div>
            </div>

            <div class="space-y-4 text-sm">
                <div>
                    <span class="block text-gray-400 text-xs uppercase font-bold tracking-wider mb-1">Release Date</span>
                    <span class="font-mono">2026-01-30</span>
                </div>
                <div>
                    <span class="block text-gray-400 text-xs uppercase font-bold tracking-wider mb-1">Type</span>
                    <span>Visual Encoder / VQ-GAN Variant</span>
                </div>
                <div>
                    <span class="block text-gray-400 text-xs uppercase font-bold tracking-wider mb-1">Parameters</span>
                    <span class="font-mono">~40M (Est.)</span>
                </div>
                <div>
                    <span class="block text-gray-400 text-xs uppercase font-bold tracking-wider mb-1">Framework</span>
                    <span class="font-mono">PyTorch / Orbit</span>
                </div>
            </div>

            <div class="pt-6 border-t border-gray-200">
                <a href="https://huggingface.co/A03HCY/Codon-Motif-vision-1" target="_blank" class="block w-full text-center py-2 bg-gray-900 text-white text-sm font-medium rounded-lg hover:bg-black transition mb-3">
                    Hugging Face
                </a>
                <a href="https://www.modelscope.cn/models/Hopkins/Codon-Motif-vision-1" target="_blank" class="block w-full text-center py-2 bg-gray-900 text-white text-sm font-medium rounded-lg hover:bg-black transition mb-3">
                    ModelScope
                </a>
            </div>
        </aside>

        <!-- Main Content -->
        <section class="w-full md:w-3/4 space-y-16 min-w-0">
            
            <!-- 1. Model Introduction -->
            <div>
                <h2 class="text-lg font-bold text-gray-900 mb-4">模型介绍</h2>
                <p class="text-gray-600 leading-relaxed text-sm md:text-base">
                    <strong>Codon Motif Vision 1</strong> 是一个实验性的视觉 Tokenizer (Visual Tokenizer) 模型，可以支持任意尺度图片。
                </p>
            </div>

            <!-- 2. Data Flow -->
            <div>
                <h2 class="text-lg font-bold text-gray-900 mb-6">Data Flow</h2>
                <div class="bg-white p-6 rounded-xl border border-gray-200">
                    <div class="flex flex-col md:flex-row items-center justify-between text-xs font-mono text-gray-600 gap-2">
                        <div class="w-full md:w-auto bg-gray-50 border border-gray-200 px-4 py-3 rounded text-center">
                            Input<br><span class="text-[10px] text-gray-400">[B, 3, H, W]</span>
                        </div>
                        <span class="flow-arrow">→</span>
                        <div class="w-full md:w-auto bg-blue-50 border border-blue-100 text-blue-700 px-4 py-3 rounded text-center">
                            Encoder<br><span class="text-[10px] opacity-70">Conv + Attn</span>
                        </div>
                        <span class="flow-arrow">→</span>
                        <div class="w-full md:w-auto bg-gray-900 text-white px-4 py-3 rounded text-center shadow-lg transform md:scale-110">
                            Quantizer<br><span class="text-[10px] opacity-70">LFQ (Codebook)</span>
                        </div>
                        <span class="flow-arrow">→</span>
                        <div class="w-full md:w-auto bg-blue-50 border border-blue-100 text-blue-700 px-4 py-3 rounded text-center">
                            Decoder<br><span class="text-[10px] opacity-70">PixelShuffle</span>
                        </div>
                        <span class="flow-arrow">→</span>
                        <div class="w-full md:w-auto bg-gray-50 border border-gray-200 px-4 py-3 rounded text-center">
                            Output<br><span class="text-[10px] text-gray-400">Reconstruction</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 3. Technical Specifications -->
            <div>
                <h2 class="text-lg font-bold text-gray-900 mb-6">技术规格</h2>
                <div class="bg-white rounded-xl border border-gray-200 divide-y divide-gray-100">
                    <div class="p-4">
                        <span class="font-bold text-gray-900 text-sm">量化 (Quantizer)</span>
                        <p class="mt-1 text-xs text-gray-600">采用 <strong>LFQ (Lookup Free Quantization)</strong>，一种无查表的向量量化技术，计算包含熵 (Entropy) 和困惑度 (Perplexity)。</p>
                    </div>
                    <div class="p-4">
                        <span class="font-bold text-gray-900 text-sm">位置编码</span>
                        <p class="mt-1 text-xs text-gray-600">集成 <strong>2D RoPE (Rotary Positional Embedding)</strong> 二维旋转位置编码，增强空间感知。</p>
                    </div>
                    <div class="p-4">
                        <span class="font-bold text-gray-900 text-sm">注意力机制</span>
                        <p class="mt-1 text-xs text-gray-600">Encoder 和 Decoder 均使用 <strong>Spatial Multi-Head Attention</strong> (空间多头注意力)。</p>
                    </div>
                    <div class="p-4">
                        <span class="font-bold text-gray-900 text-sm">编码器 (Encoder)</span>
                        <p class="mt-1 text-xs text-gray-600">结合 ConvBlock 和 ResBasicBlock，支持动态输入尺寸。</p>
                    </div>
                    <div class="p-4">
                        <span class="font-bold text-gray-900 text-sm">解码器 (Decoder)</span>
                        <p class="mt-1 text-xs text-gray-600">使用 <strong>PixelShuffle</strong> 进行上采样重建。</p>
                    </div>
                </div>
            </div>

            <!-- 4. Model Parameters & Files -->
            <div>
                <h2 class="text-lg font-bold text-gray-900 mb-6">模型参数与文件</h2>
                
                <h3 class="font-bold text-gray-800 mb-3 text-sm">文件清单</h3>
                <div class="bg-white rounded-xl border border-gray-200 overflow-hidden mb-6">
                    <table class="w-full text-sm text-left">
                        <thead class="bg-gray-50 text-gray-500 font-medium border-b border-gray-200">
                            <tr>
                                <th class="px-4 py-3">文件名</th>
                                <th class="px-4 py-3">大小</th>
                                <th class="px-4 py-3">说明</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-100 text-gray-700">
                            <tr>
                                <td class="px-4 py-3 font-mono text-xs">motif-v1.safetensors</td>
                                <td class="px-4 py-3 text-xs">84.92MB</td>
                                <td class="px-4 py-3 text-xs">全量模型权重</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-mono text-xs">motif-v1_encoder.safetensors</td>
                                <td class="px-4 py-3 text-xs">43.32MB</td>
                                <td class="px-4 py-3 text-xs">仅 Encoder 权重</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-mono text-xs">motif-v1_decoder.safetensors</td>
                                <td class="px-4 py-3 text-xs">41.56MB</td>
                                <td class="px-4 py-3 text-xs">仅 Decoder 权重</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-mono text-xs">motif-v1_quantizer.safetensors</td>
                                <td class="px-4 py-3 text-xs">34.37KB</td>
                                <td class="px-4 py-3 text-xs">仅 Quantizer 权重</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h3 class="font-bold text-gray-800 mb-3 text-sm">默认配置</h3>
                <ul class="list-disc list-inside space-y-1 text-sm text-gray-600 bg-white p-6 rounded-xl border border-gray-200">
                    <li><strong>输入/输出通道</strong>: 3 (RGB)</li>
                    <li><strong>Patch Size</strong>: 16</li>
                    <li><strong>Latent Dim</strong>: 256</li>
                    <li><strong>Codebook Dim</strong>: 16</li>
                    <li><strong>Encoder</strong>: Hidden Dim 256, 1 ResBlock, 4 Heads</li>
                    <li><strong>Decoder</strong>: Hidden Dim 256, 3 ResBlocks, 4 Heads</li>
                    <li><strong>RoPE Max Len</strong>: 4096</li>
                </ul>
            </div>

            <!-- 5. Usage -->
            <div>
                <h2 class="text-lg font-bold text-gray-900 mb-6">使用方法</h2>
                
                <h3 class="font-bold text-gray-800 mb-3 text-sm">1. 安装依赖</h3>
                <p class="text-sm text-gray-600 mb-2">确保已安装 <code>orbit-torch</code> 库：</p>
                <div class="code-window mb-8">
                    <div class="code-content">pip install orbit-torch</div>
                </div>

                <h3 class="font-bold text-gray-800 mb-3 text-sm">2. 模型加载</h3>
                <p class="text-sm text-gray-600 mb-4">使用 <code>load_pretrained</code> 方法加载权重。权重分为全量权重和部分权重（Encoder, Decoder, Quantizer）。</p>

                <div class="space-y-6">
                    <div>
                        <h4 class="font-medium text-gray-800 text-xs uppercase tracking-wider mb-2">导入模块</h4>
                        <div class="code-window">
                            <div class="code-content"><span class="hl-kw">from</span> orbit.model.motif.vision.v1 <span class="hl-kw">import</span> MotifV1</div>
                        </div>
                    </div>

                    <div>
                        <h4 class="font-medium text-gray-800 text-xs uppercase tracking-wider mb-2">场景 A：加载全量模型</h4>
                        <div class="code-window">
                            <div class="code-content">model = MotifV1()
model.load_pretrained(<span class="hl-str">'motif-v1.safetensors'</span>)</div>
                        </div>
                    </div>

                    <div>
                        <h4 class="font-medium text-gray-800 text-xs uppercase tracking-wider mb-2">场景 B：仅使用 Encoder</h4>
                        <p class="text-xs text-gray-500 mb-2">注意：在使用 Encoder 提取 Token 时，<strong>必须</strong>同时加载 Quantizer。通过 <code>MotifV1</code> 实例访问子模块进行加载。</p>
                        <div class="code-window">
                            <div class="code-content"><span class="hl-comment"># 1. 实例化主模型</span>
model = MotifV1()

<span class="hl-comment"># 2. 分别加载权重</span>
model.encoder.load_pretrained(<span class="hl-str">'motif-v1_encoder.safetensors'</span>)
model.quantizer.load_pretrained(<span class="hl-str">'motif-v1_quantizer.safetensors'</span>)

<span class="hl-comment"># 3. 使用示例 (使用封装好的 encode 方法)</span>
<span class="hl-comment"># x = torch.randn(1, 3, 256, 256) # [B, 3, H, W]</span>
<span class="hl-comment"># indices, mask, z_q = model.encode(x)</span>
<span class="hl-comment"># print(indices.shape) # [B, H, W]</span></div>
                        </div>
                    </div>

                    <div>
                        <h4 class="font-medium text-gray-800 text-xs uppercase tracking-wider mb-2">场景 C：仅使用 Decoder</h4>
                        <p class="text-xs text-gray-500 mb-2">注意：在使用 Decoder 重建图像时，<strong>必须</strong>同时加载 Quantizer（用于将索引还原为向量）。</p>
                        <div class="code-window">
                            <div class="code-content"><span class="hl-comment"># 1. 实例化主模型</span>
model = MotifV1()

<span class="hl-comment"># 2. 分别加载权重</span>
model.decoder.load_pretrained(<span class="hl-str">'motif-v1_decoder.safetensors'</span>)
model.quantizer.load_pretrained(<span class="hl-str">'motif-v1_quantizer.safetensors'</span>)

<span class="hl-comment"># 3. 使用示例 (使用封装好的 decode 方法)</span>
<span class="hl-comment"># indices = ... # [B, H, W]</span>
<span class="hl-comment"># reconstruction = model.decode(indices)</span></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 6. Module Hierarchy -->
            <div>
                <h2 class="text-lg font-bold text-gray-900 mb-4">Module Hierarchy</h2>
                <div class="code-window">
                    <div class="code-header">
                        <!-- Clean Terminal Style Header -->
                        <span class="text-[10px] text-gray-500 font-mono flex items-center gap-2">
                            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4"></path></svg>
                            v1_architecture.log
                        </span>
                    </div>
                    <div class="code-content"><span class="hl-cls">MotifV1</span>(
  <span class="hl-comment"># Encoder: Compresses image to latent space</span>
  (<span class="hl-attr">encoder</span>): <span class="hl-cls">MotifV1Encoder</span>(
    (<span class="hl-attr">down_blocks</span>): <span class="hl-cls">ModuleList</span>(
      <span class="hl-comment"># Series of ResBlocks and Downsample Convs</span>
      (0): <span class="hl-cls">ResBasicBlock</span>(...)
      (1): <span class="hl-cls">ConvBlock</span>(stride=<span class="hl-num">2</span>)
      ...
    )
    (<span class="hl-attr">mid_attn</span>): <span class="hl-cls">SpatialMultiHeadAttention</span>(
      (<span class="hl-attr">rope</span>): <span class="hl-cls">MRoPEInterleavedEmbedding</span>()
      (<span class="hl-attr">q_proj</span>): <span class="hl-cls">Linear</span>(in=<span class="hl-num">256</span>, out=<span class="hl-num">256</span>)
    )
  )

  <span class="hl-comment"># Quantization: Continuous -> Discrete</span>
  (<span class="hl-attr">quantizer</span>): <span class="hl-cls">LFQ</span>(
    (<span class="hl-attr">project_in</span>): <span class="hl-cls">Linear</span>(in=<span class="hl-num">256</span>, out=<span class="hl-num">14</span>)
    (<span class="hl-attr">project_out</span>): <span class="hl-cls">Linear</span>(in=<span class="hl-num">14</span>, out=<span class="hl-num">256</span>)
  )

  <span class="hl-comment"># Decoder: Reconstructs image from latent</span>
  (<span class="hl-attr">decoder</span>): <span class="hl-cls">MotifV1Decoder</span>(
    (<span class="hl-attr">mid_attn</span>): <span class="hl-cls">SpatialMultiHeadAttention</span>(...)
    (<span class="hl-attr">up_blocks</span>): <span class="hl-cls">ModuleList</span>(
      (0): <span class="hl-cls">ResBasicBlock</span>(...)
      (1): <span class="hl-cls">Sequential</span>(
        (<span class="hl-attr">0</span>): <span class="hl-cls">ConvBlock</span>(...)
        (<span class="hl-attr">1</span>): <span class="hl-cls">PixelShuffle</span>(upscale_factor=<span class="hl-num">2</span>)
      )
      ...
    )
    (<span class="hl-attr">conv_out</span>): <span class="hl-cls">Conv2d</span>(out=<span class="hl-num">3</span>)
  )
)</div>
                </div>
            </div>

        </section>
    </main>

    <footer class="mt-auto py-8 px-6 border-t border-gray-200 bg-white">
        <div class="max-w-6xl mx-auto text-center text-xs text-gray-400">
            &copy; 2026 Codon Lab.
        </div>
    </footer>

</body>
</html>
