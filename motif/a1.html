<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Motif A1 Specs - Codon Lab</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #fafafa; color: #171717; }
        .font-mono { font-family: 'JetBrains Mono', monospace; }
        .grid-bg {
            background-image: linear-gradient(#e5e5e5 1px, transparent 1px),
            linear-gradient(90deg, #e5e5e5 1px, transparent 1px);
            background-size: 40px 40px;
            background-position: center top;
        }
        .glass-card {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }
        
        /* Code Block Styling */
        .code-window {
            background-color: #0f1115; /* Dark Navy for A1 */
            border-radius: 0.5rem;
            overflow: hidden;
            border: 1px solid #1f2937;
        }
        .code-header {
            background-color: #1a202c;
            padding: 0.5rem 1rem;
            display: flex;
            align-items: center;
            border-bottom: 1px solid #2d3748;
        }
        .code-content {
            color: #e2e8f0;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            line-height: 1.6;
            padding: 1.25rem;
            overflow-x: auto;
            white-space: pre-wrap; 
            word-break: break-all;
        }
        
        /* Syntax Highlighting */
        .hl-cls { color: #60a5fa; font-weight: bold; } /* Blue for Classes */
        .hl-attr { color: #93c5fd; } 
        .hl-num { color: #f87171; } 
        .hl-str { color: #34d399; } 
        .hl-kw { color: #c084fc; } /* Purple for keywords */
        .hl-comment { color: #6b7280; font-style: italic; } 
        
        .flow-arrow {
            color: #cbd5e1; 
            font-size: 1.25rem;
        }
        @media (max-width: 768px) {
            .flow-arrow { transform: rotate(90deg); margin: 0.5rem 0; }
        }

        /* Mobile Menu */
        #mobile-menu {
            transition: all 0.3s ease-in-out;
            max-height: 0;
            overflow: hidden;
        }
        #mobile-menu.open {
            max-height: 200px;
            padding-bottom: 1rem;
        }
    </style>
</head>
<body class="grid-bg min-h-screen flex flex-col">

    <!-- Responsive Nav -->
    <nav class="w-full glass-card sticky top-0 z-50">
        <div class="max-w-6xl mx-auto px-6 py-4 flex justify-between items-center">
            <a href="/" class="text-lg font-semibold tracking-tight flex items-center gap-2 text-gray-900">
                <div class="w-2.5 h-2.5 bg-blue-600 rounded-sm"></div>
                Codon Lab
            </a>
            
            <div class="hidden md:flex gap-4 text-sm font-medium text-gray-500">
                <a href="/models" class="hover:text-black transition flex items-center gap-1">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg>
                    Back to Models
                </a>
            </div>

             <!-- Mobile Toggle -->
             <button id="menu-toggle" class="md:hidden p-1 text-gray-500 hover:text-black">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path id="menu-icon" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
            </button>
        </div>

        <div id="mobile-menu" class="md:hidden px-6 bg-white/50 border-b border-gray-100/50">
            <div class="flex flex-col py-2 text-sm font-medium text-gray-600">
                <a href="/models" class="py-2 flex items-center gap-2">
                    <span>←</span> Back to Models
                </a>
            </div>
        </div>
    </nav>

    <main class="max-w-6xl mx-auto w-full px-6 py-12 md:flex gap-16 items-start">
        
        <!-- Sidebar: Meta Info -->
        <aside class="w-full md:w-1/4 mb-10 md:mb-0 space-y-8 flex-shrink-0 md:sticky md:top-28 self-start">
            <div>
                <h1 class="text-3xl font-bold text-gray-900 mb-2">Motif A1</h1>
                <div class="inline-flex items-center gap-2 px-2 py-1 bg-blue-50 text-blue-700 text-xs font-mono rounded border border-blue-100">
                    <span class="relative flex h-2 w-2">
                      <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-blue-400 opacity-75"></span>
                      <span class="relative inline-flex rounded-full h-2 w-2 bg-blue-500"></span>
                    </span>
                    ACTIVE RESEARCH
                </div>
            </div>

            <div class="space-y-5 text-sm">
                <div>
                    <span class="block text-gray-400 text-xs uppercase font-bold tracking-wider mb-1">Architecture</span>
                    <span class="font-mono text-gray-700">Transformer Decoder (Causal)</span>
                </div>
                <div>
                    <span class="block text-gray-400 text-xs uppercase font-bold tracking-wider mb-1">Key Features</span>
                    <ul class="font-mono text-gray-700 text-xs space-y-1">
                        <li>• Rotary Embeddings (RoPE)</li>
                        <li>• Gated MLP (SwiGLU)</li>
                        <li>• GQA (Grouped Query Attn)</li>
                    </ul>
                </div>
                <div>
                    <span class="block text-gray-400 text-xs uppercase font-bold tracking-wider mb-1">Context Window</span>
                    <span class="font-mono text-gray-700">2048 Tokens (Base)</span>
                </div>
                <div>
                    <span class="block text-gray-400 text-xs uppercase font-bold tracking-wider mb-1">Framework</span>
                    <span class="font-mono text-gray-700">PyTorch / Orbit</span>
                </div>
            </div>

            <div class="pt-6 border-t border-gray-200">
                <button disabled class="block w-full text-center py-2 bg-gray-100 text-gray-400 text-sm font-medium rounded-lg cursor-not-allowed mb-2">
                    HF Weights (Coming Soon)
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <section class="w-full md:w-3/4 space-y-16 min-w-0">
            
            <!-- 1. Introduction -->
            <div>
                <h2 class="text-lg font-bold text-gray-900 mb-4">简介</h2>
                <p class="text-gray-600 leading-relaxed text-sm md:text-base">
                    <strong>Motif A1</strong> 是 Codon Lab 开发的基础生成式语言模型架构。它移除了传统 Transformer 中的绝对位置编码，转而采用旋转位置编码 (RoPE)，并使用 RMSNorm 进行前置归一化，显著提升了推理过程中的数值稳定性与长序列泛化能力。
                </p>
            </div>

            <!-- 2. Data Flow (LLM Style) -->
            <div>
                <h2 class="text-lg font-bold text-gray-900 mb-6">Pipeline Logic</h2>
                <div class="bg-white p-6 rounded-xl border border-gray-200">
                    <div class="flex flex-col md:flex-row items-center justify-between text-xs font-mono text-gray-600 gap-3">
                        <div class="bg-gray-50 border border-gray-200 px-4 py-3 rounded text-center w-full md:w-auto">
                            Token IDs<br><span class="text-[10px] text-gray-400">[B, Seq]</span>
                        </div>
                        <span class="flow-arrow">→</span>
                        <div class="bg-blue-50 border border-blue-100 text-blue-700 px-4 py-3 rounded text-center w-full md:w-auto">
                            Embedding<br><span class="text-[10px] opacity-70">Lookup + Dropout</span>
                        </div>
                        <span class="flow-arrow">→</span>
                        <div class="bg-gray-900 text-white px-5 py-4 rounded text-center shadow-lg transform md:scale-110 w-full md:w-auto">
                            Decoder Layers<br>
                            <span class="text-[10px] text-gray-300 block mt-1">Attn (RoPE) + Gated MLP</span>
                            <span class="text-[10px] text-gray-500">x Layers</span>
                        </div>
                        <span class="flow-arrow">→</span>
                        <div class="bg-blue-50 border border-blue-100 text-blue-700 px-4 py-3 rounded text-center w-full md:w-auto">
                            RMSNorm
                        </div>
                        <span class="flow-arrow">→</span>
                        <div class="bg-gray-50 border border-gray-200 px-4 py-3 rounded text-center w-full md:w-auto">
                            Logits<br><span class="text-[10px] text-gray-400">[B, Seq, Vocab]</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 3. Technical Specs -->
            <div>
                <h2 class="text-lg font-bold text-gray-900 mb-6">技术规格详解</h2>
                <div class="grid md:grid-cols-2 gap-4">
                    <div class="bg-white p-5 rounded-xl border border-gray-200">
                        <div class="flex items-center gap-2 mb-2">
                            <span class="w-2 h-2 bg-blue-500 rounded-full"></span>
                            <span class="font-bold text-gray-900 text-sm">Attention Mechanism</span>
                        </div>
                        <p class="text-xs text-gray-600 leading-relaxed">
                            支持 <strong>GQA (Grouped Query Attention)</strong>。通过配置 <code>num_kv_heads</code> < <code>num_heads</code>，大幅减少 KV Cache 显存占用，提升推理可以支持的 Batch Size。
                        </p>
                    </div>
                    <div class="bg-white p-5 rounded-xl border border-gray-200">
                        <div class="flex items-center gap-2 mb-2">
                            <span class="w-2 h-2 bg-purple-500 rounded-full"></span>
                            <span class="font-bold text-gray-900 text-sm">Positional Encoding</span>
                        </div>
                        <p class="text-xs text-gray-600 leading-relaxed">
                            采用 <strong>Rotary Embedding (RoPE)</strong>。将位置信息注入到 Query 和 Key 的旋转角度中，使得相对位置关系在注意力计算中自然保留。
                        </p>
                    </div>
                    <div class="bg-white p-5 rounded-xl border border-gray-200">
                        <div class="flex items-center gap-2 mb-2">
                            <span class="w-2 h-2 bg-green-500 rounded-full"></span>
                            <span class="font-bold text-gray-900 text-sm">Feed Forward</span>
                        </div>
                        <p class="text-xs text-gray-600 leading-relaxed">
                            使用 <strong>Gated MLP</strong> (带有 Gate 机制的 MLP)。相比标准 MLP，提供了更强的非线性表达能力，通常配合 SiLU 激活函数。
                        </p>
                    </div>
                    <div class="bg-white p-5 rounded-xl border border-gray-200">
                        <div class="flex items-center gap-2 mb-2">
                            <span class="w-2 h-2 bg-orange-500 rounded-full"></span>
                            <span class="font-bold text-gray-900 text-sm">Normalization</span>
                        </div>
                        <p class="text-xs text-gray-600 leading-relaxed">
                            全链路使用 <strong>RMSNorm (Root Mean Square Layer Normalization)</strong>，去除了 LayerNorm 中的中心化操作，计算更高效且收敛更稳。
                        </p>
                    </div>
                </div>
            </div>

            <!-- 4. Architecture Tree -->
            <div>
                <h2 class="text-lg font-bold text-gray-900 mb-4">Module Hierarchy</h2>
                <div class="code-window">
                    <div class="code-content"><span class="hl-cls">A1Model</span>(
  (<span class="hl-attr">token_emb</span>): <span class="hl-cls">Embedding</span>(<span class="hl-num">32000</span>, <span class="hl-num">512</span>)
  (<span class="hl-attr">rope_emb</span>): <span class="hl-cls">RotaryPositionalEmbedding</span>(dim=<span class="hl-num">64</span>, max_len=<span class="hl-num">2048</span>)
  
  (<span class="hl-attr">layers</span>): <span class="hl-cls">ModuleList</span>(
    (0-7): <span class="hl-cls">A1Decoder</span>(
      (<span class="hl-attr">attn_norm</span>): <span class="hl-cls">RMSNorm</span>(<span class="hl-num">512</span>)
      (<span class="hl-attr">attn</span>): <span class="hl-cls">MultiHeadAttention</span>(
        heads=<span class="hl-num">8</span>, kv_heads=<span class="hl-num">2</span>
        <span class="hl-comment"># Uses Rotary Embeddings internally</span>
      )
      
      (<span class="hl-attr">ffn_norm</span>): <span class="hl-cls">RMSNorm</span>(<span class="hl-num">512</span>)
      (<span class="hl-attr">ffn</span>): <span class="hl-cls">MLP</span>(
        in=<span class="hl-num">512</span>, hidden=<span class="hl-num">1024</span>, gate=<span class="hl-kw">True</span>
      )
    )
  )
  
  (<span class="hl-attr">norm</span>): <span class="hl-cls">RMSNorm</span>(<span class="hl-num">512</span>)
  (<span class="hl-attr">proj_out</span>): <span class="hl-cls">Linear</span>(in=<span class="hl-num">512</span>, out=<span class="hl-num">32000</span>, bias=<span class="hl-kw">False</span>)
)</div>
                </div>
            </div>

        </section>
    </main>

    <footer class="mt-auto py-10 px-6 border-t border-gray-200 bg-white">
        <div class="max-w-6xl mx-auto text-center text-xs text-gray-400">
            &copy; 2026 Codon Lab. Research builds only.
        </div>
    </footer>

    <script>
        // Simple Mobile Menu Toggle
        const btn = document.getElementById('menu-toggle');
        const menu = document.getElementById('mobile-menu');
        const icon = document.getElementById('menu-icon');

        btn.addEventListener('click', () => {
            menu.classList.toggle('open');
            // Icon transition
            if (menu.classList.contains('open')) {
                icon.setAttribute('d', 'M6 18L18 6M6 6l12 12');
            } else {
                icon.setAttribute('d', 'M4 6h16M4 12h16m-7 6h7');
            }
        });
    </script>
</body>
</html>